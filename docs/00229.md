# åŸºäº Face-api.js çš„ç½‘ç»œäººè„¸æ£€æµ‹

> åŸæ–‡:[https://www.sitepoint.com/face-api-js-face-detection/](https://www.sitepoint.com/face-api-js-face-detection/)

ç½‘ç»œæµè§ˆå™¨å˜å¾—æ—¥ç›Šå¼ºå¤§ã€‚ç½‘ç«™å’Œç½‘ç»œåº”ç”¨ç¨‹åºçš„å¤æ‚æ€§ä¹Ÿåœ¨å¢åŠ ã€‚å‡ åå¹´å‰éœ€è¦è¶…çº§è®¡ç®—æœºçš„æ“ä½œç°åœ¨å¯ä»¥åœ¨æ™ºèƒ½æ‰‹æœºä¸Šè¿è¡Œã€‚å…¶ä¸­ä¹‹ä¸€å°±æ˜¯äººè„¸æ£€æµ‹ã€‚

æ£€æµ‹å’Œåˆ†æé¢éƒ¨çš„èƒ½åŠ›éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿæ·»åŠ å·§å¦™çš„ç‰¹å¾ã€‚æƒ³è±¡ä¸€ä¸‹è‡ªåŠ¨æ¨¡ç³Šé¢éƒ¨(åƒè°·æ­Œåœ°å›¾ä¸€æ ·)ï¼Œå¹³ç§»å’Œç¼©æ”¾ç½‘ç»œæ‘„åƒå¤´ä»¥èšç„¦äººç‰©(åƒå¾®è½¯å›¢é˜Ÿ)ï¼ŒéªŒè¯æŠ¤ç…§ï¼Œæ·»åŠ æ„šè ¢çš„è¿‡æ»¤å™¨(åƒ Instagram å’Œ Snapchat)ç­‰ç­‰ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬åšè¿™äº›ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ‰¾åˆ°é‚£å¼ è„¸ï¼

[Face-api.js](https://github.com/justadudewhohacks/face-api.js) æ˜¯ä¸€ä¸ªåº“ï¼Œå®ƒä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿåœ¨ä»–ä»¬çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äººè„¸æ£€æµ‹ï¼Œè€Œä¸éœ€è¦æœºå™¨å­¦ä¹ çš„èƒŒæ™¯ã€‚

æœ¬æ•™ç¨‹çš„ä»£ç å¯ä»¥åœ¨ [GitHub](https://github.com/sitepoint-editors/demo-face-api-js) ä¸Šæ‰¾åˆ°ã€‚

## åŸºäºæœºå™¨å­¦ä¹ çš„äººè„¸æ£€æµ‹

æ¢æµ‹ç‰©ä½“ï¼Œæ¯”å¦‚äººè„¸ï¼Œæ˜¯ç›¸å½“å¤æ‚çš„ã€‚æƒ³æƒ³çœ‹:ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ‰«æåƒç´ æ¥æ‰¾åˆ°çœ¼ç›ã€é¼»å­å’Œå˜´ã€‚è¿™æ˜¯å¯ä»¥åšåˆ°çš„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°è®¸å¤šå› ç´ ï¼Œè¦åšåˆ°å®Œå…¨å¯é å®é™…ä¸Šæ˜¯ä¸å¯èƒ½çš„ã€‚æƒ³æƒ³å…‰çº¿æ¡ä»¶ï¼Œé¢éƒ¨æ¯›å‘ï¼Œå„ç§å„æ ·çš„å½¢çŠ¶å’Œé¢œè‰²ï¼ŒåŒ–å¦†ï¼Œè§’åº¦ï¼Œé¢å…·ç­‰ç­‰ã€‚

ç„¶è€Œï¼Œç¥ç»ç½‘ç»œæ“…é•¿å¤„ç†è¿™ç±»é—®é¢˜ï¼Œå¯ä»¥æ¨å¹¿åˆ°å¤§å¤šæ•°(å¦‚æœä¸æ˜¯å…¨éƒ¨)æƒ…å†µã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ TensorFlow.js(ä¸€ä¸ªæµè¡Œçš„ JavaScript æœºå™¨å­¦ä¹ åº“)åœ¨æµè§ˆå™¨ä¸­åˆ›å»ºã€è®­ç»ƒå’Œä½¿ç”¨ç¥ç»ç½‘ç»œã€‚ç„¶è€Œï¼Œå³ä½¿æˆ‘ä»¬ä½¿ç”¨ç°æˆçš„ã€é¢„å…ˆè®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œæˆ‘ä»¬ä»ç„¶ä¼šå¯¹å‘ TensorFlow æä¾›ä¿¡æ¯å¹¶è§£é‡Šè¾“å‡ºçš„æœ¬è´¨æœ‰æ‰€äº†è§£ã€‚å¦‚æœä½ å¯¹æœºå™¨å­¦ä¹ çš„æŠ€æœ¯ç»†èŠ‚æ„Ÿå…´è¶£ï¼Œè¯·æŸ¥çœ‹â€œ[ç”¨ Python è¿›è¡Œæœºå™¨å­¦ä¹ çš„åˆçº§è¯»æœ¬](https://www.sitepoint.com/machine-learning-python-primer/)â€ã€‚

è¾“å…¥ face-api.jsï¼Œå®ƒå°†æ‰€æœ‰è¿™äº›éƒ½å°è£…åˆ°ä¸€ä¸ªç›´è§‚çš„ api ä¸­ã€‚æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ª`img`ã€`canvas`æˆ–`video` DOM å…ƒç´ ï¼Œåº“å°†è¿”å›ä¸€ä¸ªæˆ–ä¸€ç»„ç»“æœã€‚js å¯ä»¥æ£€æµ‹äººè„¸ï¼Œä½†ä¹Ÿå¯ä»¥ä¼°è®¡äººè„¸ä¸­çš„å„ç§ä¸œè¥¿ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

*   **äººè„¸æ£€æµ‹**:è·å–ä¸€å¼ æˆ–å¤šå¼ äººè„¸çš„è¾¹ç•Œã€‚è¿™æœ‰åŠ©äºç¡®å®šå›¾ç‰‡ä¸­äººè„¸çš„ä½ç½®å’Œå¤§å°ã€‚
*   **äººè„¸åœ°æ ‡æ£€æµ‹**:è·å–çœ‰æ¯›ã€çœ¼ç›ã€é¼»å­ã€å˜´å·´å’Œå˜´å”‡ã€ä¸‹å·´çš„ä½ç½®å’Œå½¢çŠ¶ã€‚è¿™å¯ä»¥ç”¨äºç¡®å®šé¢å‘æ–¹å‘æˆ–åœ¨ç‰¹å®šåŒºåŸŸæŠ•å½±å›¾å½¢ï¼Œå¦‚é¼»å­å’Œå˜´å”‡ä¹‹é—´çš„å°èƒ¡å­ã€‚
*   **é¢éƒ¨è¯†åˆ«**:ç¡®å®šç…§ç‰‡ä¸­çš„äººæ˜¯è°ã€‚
*   **é¢éƒ¨è¡¨æƒ…æ£€æµ‹**:ä»ä¸€å¼ è„¸ä¸Šè·å–è¡¨æƒ…ã€‚è¯·æ³¨æ„ï¼Œé‡Œç¨‹å¯èƒ½å› ä¸åŒçš„æ–‡åŒ–è€Œå¼‚ã€‚
*   **å¹´é¾„å’Œæ€§åˆ«æ£€æµ‹**:ä»äººè„¸è·å–å¹´é¾„å’Œæ€§åˆ«ã€‚è¯·æ³¨æ„ï¼Œå¯¹äºâ€œæ€§åˆ«â€åˆ†ç±»ï¼Œå®ƒå°†ä¸€å¼ è„¸åˆ†ç±»ä¸ºå¥³æ€§åŒ–æˆ–ç”·æ€§åŒ–ï¼Œè¿™ä¸ä¸€å®šä¼šæ­ç¤ºä»–ä»¬çš„æ€§åˆ«ã€‚

åœ¨ä½ ä½¿ç”¨è¿™äº›è¶…è¶Šå®éªŒçš„ä¸œè¥¿ä¹‹å‰ï¼Œè¯·æ³¨æ„äººå·¥æ™ºèƒ½æ“…é•¿æ”¾å¤§åè§ã€‚æ€§åˆ«åˆ†ç±»å¯¹åŒæ€§åŒ–çš„äººå¾ˆç®¡ç”¨ï¼Œä½†æ˜¯å®ƒä¸èƒ½æ£€æµ‹æˆ‘çš„éåŒæ€§æœ‹å‹çš„æ€§åˆ«ã€‚å®ƒåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥è¯†åˆ«ç™½äººï¼Œä½†ç»å¸¸æ— æ³•æ£€æµ‹æœ‰è‰²äººç§ã€‚

åœ¨ä½¿ç”¨è¿™é¡¹æŠ€æœ¯æ—¶è¦éå¸¸æ…é‡ï¼Œå¹¶ä¸”è¦å’Œä¸åŒçš„æµ‹è¯•å›¢é˜Ÿä¸€èµ·è¿›è¡Œå½»åº•çš„æµ‹è¯•ã€‚

## è£…ç½®

æˆ‘ä»¬å¯ä»¥é€šè¿‡ npm å®‰è£… face-api.js:

```
npm install face-api.js 
```

ç„¶è€Œï¼Œä¸ºäº†è·³è¿‡æ„å»ºå·¥å…·çš„è®¾ç½®ï¼Œæˆ‘å°†é€šè¿‡ unpkg.org åŒ…å« UMD åŒ…:

```
/* globals faceapi */
import 'https://unpkg.com/face-api.js@0.22.2/dist/face-api.min.js'; 
```

ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä»åº“çš„ä»“åº“ä¸­ä¸‹è½½æ­£ç¡®çš„[é¢„è®­ç»ƒæ¨¡å‹ã€‚ç¡®å®šæˆ‘ä»¬æƒ³ä»äººè„¸ä¸­äº†è§£ä»€ä¹ˆï¼Œå¹¶ä½¿ç”¨](https://github.com/justadudewhohacks/face-api.js/tree/master/weights)[å¯ç”¨æ¨¡å‹éƒ¨åˆ†](https://github.com/justadudewhohacks/face-api.js#models)æ¥ç¡®å®šéœ€è¦å“ªäº›æ¨¡å‹ã€‚ä¸€äº›åŠŸèƒ½é€‚ç”¨äºå¤šä¸ªæ¨¡å‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨å¸¦å®½/æ€§èƒ½å’Œå‡†ç¡®æ€§ä¹‹é—´åšå‡ºé€‰æ‹©ã€‚æ¯”è¾ƒå„ç§å¯ç”¨æ¨¡å‹çš„æ–‡ä»¶å¤§å°ï¼Œå¹¶é€‰æ‹©æ‚¨è®¤ä¸ºæœ€é€‚åˆæ‚¨çš„é¡¹ç›®çš„æ¨¡å‹ã€‚

ä¸ç¡®å®šæ‚¨éœ€è¦å“ªäº›å‹å·ä¾›æ‚¨ä½¿ç”¨ï¼Ÿæ‚¨å¯ä»¥ç¨åè¿”å›åˆ°è¿™ä¸€æ­¥ã€‚å½“æˆ‘ä»¬åœ¨æ²¡æœ‰åŠ è½½æ‰€éœ€æ¨¡å‹çš„æƒ…å†µä¸‹ä½¿ç”¨ API æ—¶ï¼Œå°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼ŒæŒ‡å‡ºåº“éœ€è¦å“ªä¸ªæ¨¡å‹ã€‚

![console error message](../Images/6294fdbcd8273cb3af713aba8eaeb36e.png)

æˆ‘ä»¬ç°åœ¨å‡†å¤‡ä½¿ç”¨[face-API . js API](https://github.com/justadudewhohacks/face-api.js#high-level-api)ã€‚

## ä¾‹å­

è®©æˆ‘ä»¬é€ äº›ä¸œè¥¿å§ï¼

å¯¹äºä¸‹é¢çš„ä¾‹å­ï¼Œæˆ‘å°†ç”¨è¿™ä¸ªå‡½æ•°ä» [Unsplash æº](https://source.unsplash.com)åŠ è½½ä¸€ä¸ªéšæœºå›¾åƒ:

```
function loadRandomImage() {
  const image = new Image();

  image.crossOrigin = true;

  return new Promise((resolve, reject) => {
    image.addEventListener('error', (error) => reject(error));
    image.addEventListener('load', () => resolve(image));
    image.src = 'https://source.unsplash.com/512x512/?face,friends';
  });
} 
```

### è£å‰ªå›¾ç‰‡

ä½ å¯ä»¥åœ¨é™„å¸¦çš„ [GitHub repo](https://github.com/sitepoint-editors/demo-face-api-js/blob/main/scripts/1-image-crop.js) ä¸­æ‰¾åˆ°è¿™ä¸ªæ¼”ç¤ºçš„ä»£ç ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»é€‰æ‹©å¹¶åŠ è½½æ¨¡å‹ã€‚è¦è£å‰ªå›¾åƒï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“äººè„¸çš„è¾¹ç•Œæ¡†ï¼Œæ‰€ä»¥äººè„¸æ£€æµ‹å°±å¤Ÿäº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ç§æ¨¡å‹æ¥åšåˆ°è¿™ä¸€ç‚¹:SSD Mobilenet v1 æ¨¡å‹(ç•¥ä½äº 6MB)å’Œå¾®å‹äººè„¸æ£€æµ‹å™¨æ¨¡å‹(ä½äº 200KB)ã€‚å‡è®¾å‡†ç¡®æ€§æ— å…³ç´§è¦ï¼Œå› ä¸ºç”¨æˆ·ä¹Ÿå¯ä»¥é€‰æ‹©æ‰‹åŠ¨è£å‰ªã€‚æ­¤å¤–ï¼Œè®©æˆ‘ä»¬å‡è®¾è®¿é—®è€…åœ¨æ…¢é€Ÿäº’è”ç½‘è¿æ¥ä¸Šä½¿ç”¨è¯¥åŠŸèƒ½ã€‚å› ä¸ºæˆ‘ä»¬çš„é‡ç‚¹æ˜¯å¸¦å®½å’Œæ€§èƒ½ï¼Œæˆ‘ä»¬å°†é€‰æ‹©æ›´å°çš„å¾®å‹äººè„¸æ£€æµ‹å™¨æ¨¡å‹ã€‚

ä¸‹è½½æ¨¡å‹åï¼Œæˆ‘ä»¬å¯ä»¥åŠ è½½å®ƒ:

```
await faceapi.nets.tinyFaceDetector.loadFromUri('/models'); 
```

æˆ‘ä»¬ç°åœ¨å¯ä»¥åŠ è½½ä¸€ä¸ªå›¾åƒå¹¶å°†å…¶ä¼ é€’ç»™ Face-API . jsã€‚`faceapi.detectAllFaces`é»˜è®¤ä½¿ç”¨ SSD Mobilenet v1 æ¨¡å‹ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»æ˜¾å¼ä¼ é€’`new faceapi.TinyFaceDetectorOptions()`æ¥å¼ºåˆ¶å®ƒä½¿ç”¨å¾®å‹äººè„¸æ£€æµ‹å™¨æ¨¡å‹ã€‚

```
const image = await loadRandomImage();
const faces = await faceapi.detectAllFaces(image, new faceapi.TinyFaceDetectorOptions()); 
```

å˜é‡`faces`ç°åœ¨åŒ…å«ä¸€ä¸ªç»“æœæ•°ç»„ã€‚æ¯ä¸ªç»“æœéƒ½æœ‰ä¸€ä¸ª`box`å’Œ`score`å±æ€§ã€‚åˆ†æ•°è¡¨ç¤ºç¥ç»ç½‘ç»œå¯¹ç»“æœç¡®å®æ˜¯äººè„¸çš„ç½®ä¿¡åº¦ã€‚`box`å±æ€§åŒ…å«ä¸€ä¸ªå¸¦æœ‰äººè„¸åæ ‡çš„å¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç¬¬ä¸€ä¸ªç»“æœ(æˆ–è€…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`faceapi.detectSingleFace()`ï¼Œä½†æ˜¯å¦‚æœç”¨æˆ·æäº¤ä¸€å¼ é›†ä½“ç…§ç‰‡ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨è£å‰ªåçš„å›¾ç‰‡ä¸­çœ‹åˆ°ä»–ä»¬æ‰€æœ‰äººã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ä¸€ä¸ªè‡ªå®šä¹‰è¾¹ç•Œæ¡†:

```
const box = {
  // Set boundaries to their inverse infinity, so any number is greater/smaller
  bottom: -Infinity,
  left: Infinity,
  right: -Infinity,
  top: Infinity,

  // Given the boundaries, we can compute width and height
  get height() {
    return this.bottom - this.top;
  },

  get width() {
    return this.right - this.left;
  },
};

// Update the box boundaries
for (const face of faces) {
  box.bottom = Math.max(box.bottom, face.box.bottom);
  box.left = Math.min(box.left, face.box.left);
  box.right = Math.max(box.right, face.box.right);
  box.top = Math.min(box.top, face.box.top);
} 
```

æœ€åï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç”»å¸ƒå¹¶æ˜¾ç¤ºç»“æœ:

```
const canvas = document.createElement('canvas');
const context = canvas.getContext('2d');

canvas.height = box.height;
canvas.width = box.width;

context.drawImage(
  image,
  box.left,
  box.top,
  box.width,
  box.height,
  0,
  0,
  canvas.width,
  canvas.height
); 
```

[https://codesandbox.io/embed/festive-breeze-1xlo2?fontsize=14&initialpath=%2F1-image-crop.html&module=%2F1-image-crop.html&theme=dark&view=preview](https://codesandbox.io/embed/festive-breeze-1xlo2?fontsize=14&initialpath=%2F1-image-crop.html&module=%2F1-image-crop.html&theme=dark&view=preview)

## æ”¾ç½®è¡¨æƒ…ç¬¦å·

ä½ å¯ä»¥åœ¨é™„å¸¦çš„ [GitHub repo](https://github.com/sitepoint-editors/demo-face-api-js/blob/main/scripts/2-emoji-eyes.js) ä¸­æ‰¾åˆ°è¿™ä¸ªæ¼”ç¤ºçš„ä»£ç ã€‚

ä¸ºä»€ä¹ˆä¸æ‰¾ç‚¹ä¹å­å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åˆ¶ä½œä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå°†å˜´è¡¨æƒ…ç¬¦å·(ğŸ‘„)åœ¨æ‰€æœ‰çš„çœ¼ç›ä¸Šã€‚ä¸ºäº†æ‰¾åˆ°çœ¼ç›çš„æ ‡å¿—ï¼Œæˆ‘ä»¬éœ€è¦å¦ä¸€ä¸ªæ¨¡å‹ã€‚è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯å‡†ç¡®æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ SSD Mobilenet v1 å’Œ 68 ç‚¹äººè„¸åœ°æ ‡æ£€æµ‹æ¨¡å‹ã€‚

åŒæ ·ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆåŠ è½½æ¨¡å‹å’Œå›¾åƒ:

```
await faceapi.nets.faceLandmark68Net.loadFromUri('/models');
await faceapi.nets.ssdMobilenetv1.loadFromUri('/models');

const image = await loadRandomImage(); 
```

ä¸ºäº†è·å¾—åœ°æ ‡ï¼Œæˆ‘ä»¬å¿…é¡»å°†`withFaceLandmarks()`å‡½æ•°è°ƒç”¨è¿½åŠ åˆ°`detectAllFaces()`ä¸­ï¼Œä»¥è·å¾—åœ°æ ‡æ•°æ®:

```
const faces = await faceapi
  .detectAllFaces(image)
  .withlandmarks(); 
```

å’Œä¸Šæ¬¡ä¸€æ ·ï¼Œ`faces`åŒ…å«äº†ä¸€ä¸ªç»“æœåˆ—è¡¨ã€‚é™¤äº†è„¸éƒ¨æ‰€åœ¨çš„ä½ç½®ï¼Œæ¯ä¸ªç»“æœè¿˜åŒ…å«åœ°æ ‡ç‚¹çš„åŸå§‹åˆ—è¡¨ã€‚ä¸ºäº†å¾—åˆ°æ¯ä¸ªç‰¹å¾çš„æ­£ç¡®çš„ç•Œæ ‡ï¼Œæˆ‘ä»¬éœ€è¦åˆ†å‰²ç‚¹çš„åˆ—è¡¨ã€‚å› ä¸ºç‚¹æ•°æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©ç¡¬ç¼–ç æŒ‡æ•°:

```
for (const face of faces) {
  const features = {
    jaw: face.landmarks.positions.slice(0, 17),
    eyebrowLeft: face.landmarks.positions.slice(17, 22),
    eyebrowRight: face.landmarks.positions.slice(22, 27),
    noseBridge: face.landmarks.positions.slice(27, 31),
    nose: face.landmarks.positions.slice(31, 36),
    eyeLeft: face.landmarks.positions.slice(36, 42),
    eyeRight: face.landmarks.positions.slice(42, 48),
    lipOuter: face.landmarks.positions.slice(48, 60),
    lipInner: face.landmarks.positions.slice(60),
  };

  // ...
} 
```

ç°åœ¨æˆ‘ä»¬ç»ˆäºå¯ä»¥æ‰¾ç‚¹ä¹å­äº†ã€‚æœ‰è¿™ä¹ˆå¤šé€‰æ‹©ï¼Œä½†æ˜¯è®©æˆ‘ä»¬ç”¨å˜´è¡¨æƒ…ç¬¦å·é®ä½çœ¼ç›(ğŸ‘„).

é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»ç¡®å®šè¡¨æƒ…ç¬¦å·åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Œåº”è¯¥ç”»å¤šå¤§ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªåŠ©æ‰‹å‡½æ•°ï¼Œä»ä»»æ„ä¸€ç»„ç‚¹åˆ›å»ºä¸€ä¸ªç›’å­ã€‚ç›’å­é‡Œè£…ç€æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯:

```
function getBoxFromPoints(points) {
  const box = {
    bottom: -Infinity,
    left: Infinity,
    right: -Infinity,
    top: Infinity,

    get center() {
      return {
        x: this.left + this.width / 2,
        y: this.top + this.height / 2,
      };
    },

    get height() {
      return this.bottom - this.top;
    },

    get width() {
      return this.right - this.left;
    },
  };

  for (const point of points) {
    box.left = Math.min(box.left, point.x);
    box.right = Math.max(box.right, point.x);

    box.bottom = Math.max(box.bottom, point.y);
    box.top = Math.min(box.top, point.y);
  }

  return box;
} 
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹åœ¨å›¾ç‰‡ä¸Šç”»è¡¨æƒ…ç¬¦å·äº†ã€‚å› ä¸ºæˆ‘ä»¬å¿…é¡»å¯¹ä¸¤åªçœ¼ç›éƒ½è¿™æ ·åšï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†`feature.eyeLeft`å’Œ`feature.eyeRight`æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œè¿­ä»£ï¼Œä»¥å¯¹æ¯åªçœ¼ç›æ‰§è¡Œç›¸åŒçš„ä»£ç ã€‚å‰©ä¸‹çš„å°±æ˜¯åœ¨ç”»å¸ƒä¸Šç”»è¡¨æƒ…ç¬¦å·äº†ï¼

```
for (const eye of [features.eyeLeft, features.eyeRight]) {
  const eyeBox = getBoxFromPoints(eye);
  const fontSize = 6 * eyeBox.height;

  context.font = `${fontSize}px/${fontSize}px serif`;
  context.textAlign = 'center';
  context.textBaseline = 'bottom';

  context.fillStyle = '#000';
  context.fillText('ğŸ‘„', eyeBox.center.x, eyeBox.center.y + 0.6 * fontSize);
} 
```

è¯·æ³¨æ„ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€äº›ç¥å¥‡çš„æ•°å­—æ¥è°ƒæ•´å­—ä½“å¤§å°å’Œç¡®åˆ‡çš„æ–‡æœ¬ä½ç½®ã€‚å› ä¸ºè¡¨æƒ…ç¬¦å·æ˜¯ unicodeï¼Œè€Œä¸”ç½‘ç»œä¸Šçš„æ’ç‰ˆå¾ˆå¥‡æ€ª(è‡³å°‘å¯¹æˆ‘æ¥è¯´)ï¼Œæˆ‘åªæ˜¯è°ƒæ•´æ•°å­—ï¼Œç›´åˆ°å®ƒä»¬çœ‹èµ·æ¥å·®ä¸å¤šä¸ºæ­¢ã€‚æ›´å¯é çš„æ›¿ä»£æ–¹æ³•æ˜¯ä½¿ç”¨å›¾åƒä½œä¸ºè¦†ç›–å›¾ã€‚

[https://codesandbox.io/embed/festive-breeze-1xlo2?fontsize=14&initialpath=%2F2-emoji-eyes.html&module=%2F2-emoji-eyes.html&theme=dark&view=preview](https://codesandbox.io/embed/festive-breeze-1xlo2?fontsize=14&initialpath=%2F2-emoji-eyes.html&module=%2F2-emoji-eyes.html&theme=dark&view=preview)

![Six people with a mouth emoji as eyes](../Images/e0af1cf22ffd1d41b6502d8902d5b93a.png)

## ç»“æŸçš„

js æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„åº“ï¼Œå®ƒä½¿å¾—äººè„¸æ£€æµ‹å’Œè¯†åˆ«å˜å¾—éå¸¸å®¹æ˜“ã€‚ä¸éœ€è¦ç†Ÿæ‚‰æœºå™¨å­¦ä¹ å’Œç¥ç»ç½‘ç»œã€‚æˆ‘å–œæ¬¢èƒ½å¤Ÿå®ç°çš„å·¥å…·ï¼Œè¿™ç»å¯¹æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚

æ ¹æ®æˆ‘çš„ç»éªŒï¼Œç½‘ç»œä¸Šçš„äººè„¸è¯†åˆ«ä¼šé™ä½æ€§èƒ½ã€‚æˆ‘ä»¬å¿…é¡»åœ¨å¸¦å®½å’Œæ€§èƒ½æˆ–å‡†ç¡®æ€§ä¹‹é—´åšå‡ºé€‰æ‹©ã€‚è¾ƒå°çš„æ¨¡å‹è‚¯å®šä¸å¤ªå‡†ç¡®ï¼Œä¼šåœ¨æˆ‘ä¹‹å‰æåˆ°çš„ä¸€äº›å› ç´ ä¸­æ¼æ‰ä¸€å¼ è„¸ï¼Œæ¯”å¦‚å…‰çº¿ä¸è¶³æˆ–å½“è„¸è¢«é¢å…·è¦†ç›–æ—¶ã€‚

å¾®è½¯ Azureã€è°·æ­Œäº‘ï¼Œå¯èƒ½è¿˜æœ‰å…¶ä»–ä¼ä¸šéƒ½åœ¨äº‘ä¸­æä¾›äººè„¸æ£€æµ‹ã€‚å› ä¸ºæˆ‘ä»¬é¿å…ä¸‹è½½å¤§å‹æ¨¡å‹ï¼ŒåŸºäºäº‘çš„æ£€æµ‹é¿å…äº†ç¹é‡çš„é¡µé¢è´Ÿè½½ï¼Œéšç€å®ƒçš„é¢‘ç¹æ”¹è¿›ï¼Œå¾€å¾€ä¼šæ›´å‡†ç¡®ï¼Œç”šè‡³å¯èƒ½å› ä¸ºä¼˜åŒ–çš„ç¡¬ä»¶è€Œæ›´å¿«ã€‚å¦‚æœä½ éœ€è¦é«˜åº¦çš„å‡†ç¡®æ€§ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦ç ”ç©¶ä¸€ä¸ªä½ è§‰å¾—èˆ’æœçš„è®¡åˆ’ã€‚

æˆ‘ç»å¯¹æ¨èä½¿ç”¨ face-api.js è¿›è¡Œçˆ±å¥½é¡¹ç›®ã€å®éªŒï¼Œä¹Ÿè®¸æ˜¯ MVPã€‚

## åˆ†äº«è¿™ç¯‡æ–‡ç« 